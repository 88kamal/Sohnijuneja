/*! Built with http://stenciljs.com */
const{h:t}=window.InstagramFeed;function e(t,e,i,r){for(var s,o=t.textContent;o.length>1&&-1!=(s=o.lastIndexOf(" "));){if(t.textContent=o.substring(0,s),e.scrollHeight<=i){t.textContent=o;break}o=t.textContent}return function(t,e,i,r){for(var s=t.textContent,o=s.length;o>1;)if(o=(s=s.substring(0,o-1).replace(n,"")).length,t.textContent=s+r,e.scrollHeight<=i)return!0;return!1}(t,e,i,r)}var n=/[ .,;!?'‘’“”\-–—]+$/,i=function(t,n,i){t.style.cssText+="overflow:hidden;overflow-wrap:break-word;word-wrap:break-word";var r=(n||1)*parseInt(window.getComputedStyle(t).lineHeight,10);t.scrollHeight<=r||function t(n,i,r,s){for(var o=n.childNodes,a=o.length-1;a>-1;){var l=o[a--],c=l.nodeType;if(1==c&&t(l,i,r,s)||3==c&&e(l,i,r,s))return!0;n.removeChild(l)}return!1}(t,t,r,i&&i.ellipsis||"…")},r=function(t,e,n,i){return new(n||(n=Promise))(function(r,s){function o(t){try{l(i.next(t))}catch(t){s(t)}}function a(t){try{l(i.throw(t))}catch(t){s(t)}}function l(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(o,a)}l((i=i.apply(t,e||[])).next())})};class s{constructor(){this.count=8,this.even=!1,this.captions=!1,this.link=!0,this.permalinks=!1}componentWillLoad(){this.fetchItems()}componentDidLoad(){this.even||(this.resizeAllGridItems(),window.addEventListener("resize",()=>{this.resizeAllGridItems()}))}componentDidUpdate(){this.even||setTimeout(()=>{window.dispatchEvent(new Event("resize"))},100)}resizeGridItem(t){return r(this,void 0,void 0,function*(){const e=this.element.querySelector(".grid"),n=parseInt(window.getComputedStyle(e).getPropertyValue("grid-auto-rows")),i=parseInt(window.getComputedStyle(e).getPropertyValue("grid-row-gap")),r=Math.ceil((t.querySelector(".content").getBoundingClientRect().height+i)/(n+i));t.style.gridRowEnd=`span ${r}`})}resizeAllGridItems(){return r(this,void 0,void 0,function*(){const t=this.element.querySelectorAll(".item");for(let e=0;e<t.length;e++)this.resizeGridItem(t[e]);this.clampCaptions()})}clampCaptions(){return r(this,void 0,void 0,function*(){const t=this.element.querySelectorAll(".caption p");for(let e=0;e<t.length;++e)i(t[e],2)})}url(){return`https://api.instagram.com/v1/users/${this.user}/media/recent/?access_token=${this.token}&count=${this.count}`}fetchItems(){return r(this,void 0,void 0,function*(){const t=yield(yield fetch(this.url())).json();localStorage.setItem(`instagram-feed-${this.count}-${this.user}`,JSON.stringify(t)),this.photos=t.data})}renderCaptions(e){return t("div",{class:"caption"},t("p",null,e.caption.text))}renderPhoto(e){const n=this.permalinks?"a":"div";return t(n,{class:"item",href:e.link,target:"_blank"},t("div",{class:"content"},t("smart-image",{preload:e.images.thumbnail.url,width:e.images.standard_resolution.width,height:e.images.standard_resolution.height,square:this.even,fill:this.even},t("source",{srcSet:e.images.low_resolution.url,media:"(max-width: 600px)"}),t("source",{srcSet:e.images.standard_resolution.url,media:"(min-width: 600px)"})),this.captions&&e.caption&&this.renderCaptions(e)))}render(){return t("div",null,t("div",{class:`grid ${this.even?"even":""}`},this.photos&&this.photos.map(t=>this.renderPhoto(t))),this.link&&t("div",{class:"view-more"},t("a",{href:`https://instagram.com/${this.user}`},"View more on Instagram")))}static get is(){return"instagram-feed"}static get properties(){return{captions:{type:Boolean,attr:"captions"},count:{type:Number,attr:"count"},element:{elementRef:!0},even:{type:Boolean,attr:"even"},link:{type:Boolean,attr:"link"},permalinks:{type:Boolean,attr:"permalinks"},photos:{state:!0},token:{type:String,attr:"token"},user:{type:String,attr:"user"}}}static get style(){return"instagram-feed{display:block;width:100%;overflow:hidden}instagram-feed .grid:not(.even){display:grid;grid-gap:1px 5px;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));grid-auto-rows:1px}instagram-feed .grid.even>.item{display:inline-block;float:left;vertical-align:top;height:25%;width:25%}instagram-feed .grid.even{border-spacing:16px;clear:both;overflow:hidden}\@media (max-width:700px){instagram-feed .grid.even>.item{display:inline-block;float:left;vertical-align:top;height:50%;width:50%}}\@media (max-width:400px){instagram-feed .grid.even>.item{display:inline-block;float:left;vertical-align:top;height:100%;width:100%}}instagram-feed .grid.even .item{overflow:hidden}instagram-feed .content{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;position:relative;overflow:hidden}instagram-feed .content p{margin:0;font-size:16px;line-height:24px}instagram-feed .content .caption{-webkit-transition:all .25s;transition:all .25s;position:absolute;overflow:hidden;bottom:4px;z-index:10;width:100%;padding:20px;-webkit-box-sizing:border-box;box-sizing:border-box;background:0 0}instagram-feed .content .caption::after{content:\"\";position:absolute;display:block;top:0;left:0;z-index:-1;width:100%;height:100%;background:-webkit-gradient(linear,left top,left bottom,from(rgba(255,255,255,0)),color-stop(80%,rgba(255,255,255,.9)));background:linear-gradient(to bottom,rgba(255,255,255,0) 0,rgba(255,255,255,.9) 80%)}instagram-feed .content:hover .caption{background:#fff}instagram-feed .view-more{padding-top:50vh;margin-top:-50vh;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;width:100%;height:auto;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center}"}}export{s as InstagramFeed};