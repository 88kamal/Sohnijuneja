/*! Built with http://stenciljs.com */
const{h:t}=window.InstagramFeed;function e(t,e){for(let i in e)"var(--)"!==e[i]&&t.style.setProperty(i,e[i]);return!0}class i{constructor(){this.fill=!1,this.square=!1,this.bg="transparent",this.sources=[],this.active=!1}componentWillLoad(){this.setBG(),this.prepareSources(),this.updateAspectRatio(),this.updateOrientation()}componentDidLoad(){this.addIntersectionObserver(),this.figure=this.element.shadowRoot.querySelector("figure")}handleImage(){this.active=!0}addIntersectionObserver(){"IntersectionObserver"in window?(this.io=new IntersectionObserver(t=>{t[0].isIntersecting&&(this.handleImage(),this.removeIntersectionObserver())}),this.io.observe(this.element.shadowRoot.querySelector("figure"))):setTimeout(()=>{this.handleImage()},300)}removeIntersectionObserver(){this.io&&(this.io.disconnect(),this.io=null)}setBG(){e(this.element,{"--bg":`${this.bg}`})}prepareSources(){const t=this.element.querySelectorAll("source");let e=[];[].forEach.call(t,t=>{e=[...e,t]}),this.sources=e}updateAspectRatio(){this.aspectRatio=this.height/this.width*100,this.square?e(this.element,{"--aspect_ratio":"100%","--width":`${this.width}px`,"--height":`${this.width}px`}):e(this.element,{"--aspect_ratio":`${this.aspectRatio}%`,"--width":`${this.width}px`,"--height":`${this.height}px`})}updateOrientation(){this.width>this.height?this.orientation="landscape":this.width<this.height?this.orientation="portrait":this.orientation="even"}renderPicture(){if(this.active)return this.figure.classList.add("loaded"),[this.sources.map(e=>t("source",{srcSet:e.srcset,media:e.media})),t("img",{src:this.preload,class:`final_image ${this.orientation}`})]}render(){return console.log(this.aspectRatio),t("figure",{itemtype:"http://schema.org/ImageObject","data-fill":this.fill},t("div",{class:"overlay"}),t("picture",null,this.renderPicture()),t("img",{src:this.preload,class:`placeholder ${this.orientation}`}))}static get is(){return"smart-image"}static get encapsulation(){return"shadow"}static get properties(){return{active:{state:!0},aspectRatio:{state:!0},bg:{type:String,attr:"bg"},element:{elementRef:!0},figure:{state:!0},fill:{type:Boolean,attr:"fill"},height:{type:Number,attr:"height"},io:{state:!0},orientation:{state:!0},preload:{type:String,attr:"preload"},sources:{state:!0},square:{type:Boolean,attr:"square"},width:{type:Number,attr:"width"}}}static get style(){return":host{display:inline-table;background:var(--bg,transparent);width:100%;max-width:var(--width,300px);max-height:var(--height,300px)}:host figure{display:block;position:relative;margin:0;padding-bottom:var(--aspect_ratio,100%);width:100%;height:100%}:host .overlay,:host img.placeholder,:host picture{position:absolute;top:0;left:0;-webkit-transition:all .85s cubic-bezier(.2,.3,.25,.9) 1s;transition:all .85s cubic-bezier(.2,.3,.25,.9) 1s;width:100%;height:100%;overflow:hidden;image-rendering:-moz-crisp-edges;image-rendering:-o-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:crisp-edges}:host .overlay{opacity:.5;z-index:3;pointer-events:none;background:var(--gradient,none);mix-blend-mode:var(--blend,multiply)}:host picture{-webkit-transition:all .85s cubic-bezier(.2,.3,.25,.9) 1s;transition:all .85s cubic-bezier(.2,.3,.25,.9) 1s;opacity:0;z-index:2}:host picture img.final_image{display:block;width:100%}:host figure[data-fill=true] picture img.final_image.landscape{position:absolute;height:100%;width:auto;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}:host figure[data-fill=true] picture img.final_image.portrait{height:auto;width:100%}:host img.placeholder{pointer-events:none;opacity:1;z-index:1;background:var(--bg,transparent);-webkit-filter:blur(10px);filter:blur(10px);image-rendering:-moz-crisp-edges;image-rendering:-o-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:crisp-edges;-ms-interpolation-mode:nearest-neighbor}:host figure.loaded picture{opacity:1}:host figure.loaded img.placeholder{-webkit-filter:blur(0);filter:blur(0)}:host figure.loaded .overlay{opacity:.3}"}}export{i as SmartImage};